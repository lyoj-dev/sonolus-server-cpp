# This is a basic workflow to help you get started with Actions

name: windows-build

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the "main" branch
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
  
env:
  VERSION: v1.2.0

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: windows-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v3

      # Runs a single command using the runners shell
      - name: Test Github Release
        run: echo ahahaha > test.txt

      - name: Test Github Release
        uses: marvinpinto/action-automatic-releases@latest
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          automatic_release_tag: ${{ env.VERSION }}
          title: Sonolus Server ${{ env.VERSION }}
          prerelease: false
          files: |
            test.txt
            
      - name: Setup C/C++ Compiler
        # You may pin to the exact commit or the version.
        # uses: rlalik/setup-cpp-compiler@f39db50a7fd04bfd65ce41e8fec0ac185ae59dfb
        uses: rlalik/setup-cpp-compiler@v1.2
        with:
          # Compiler to install
          compiler: gcc-latest # optional, default is gcc-latest
      
      - name: Checking gcc
        run: g++ --version
